<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Last Stand – Working Demo</title>
<style>
html,body{margin:0;padding:0;background:#000;color:#fff;overflow:hidden}
canvas{display:block;margin:auto;background:#111;touch-action:none}
</style>
</head>
<body>
<canvas id="game" width="720" height="1280"></canvas>
<script>
const W=720,H=1280,cv=document.getElementById("game"),ctx=cv.getContext("2d");
let scene="title",touch=null,units=[];
window.addEventListener("pointerdown",e=>touch={x:e.offsetX,y:e.offsetY});
window.addEventListener("pointerup",()=>touch=null);

function btn(x,y,w,h,label){
  ctx.fillStyle="#222";ctx.fillRect(x,y,w,h);
  ctx.strokeStyle="#555";ctx.strokeRect(x,y,w,h);
  ctx.fillStyle="#fff";ctx.font="28px sans-serif";ctx.textAlign="center";
  ctx.fillText(label,x+w/2,y+h/2+10);
  if(touch&&touch.x>x&&touch.x<x+w&&touch.y>y&&touch.y<y+h){touch=null;return true}
  return false;
}

function startBattle(){
  units=[];
  for(let i=0;i<20;i++)units.push({x:Math.random()*W,y:Math.random()*600+300,dx:Math.random()*2-1,dy:Math.random()*2-1,emoji:"🦍"});
  for(let i=0;i<40;i++)units.push({x:Math.random()*W,y:Math.random()*600+300,dx:Math.random()*2-1,dy:Math.random()*2-1,emoji:"🐀"});
  scene="battle";
}

function drawTitle(){
  ctx.fillStyle="#000";ctx.fillRect(0,0,W,H);
  ctx.fillStyle="#fff";ctx.font="64px sans-serif";ctx.textAlign="center";
  ctx.fillText("Last Stand",W/2,500);
  if(btn(210,800,300,90,"Start"))startBattle();
}

function drawBattle(dt){
  ctx.fillStyle="#111";ctx.fillRect(0,0,W,H);
  for(const u of units){
    u.x+=u.dx*dt*0.1;u.y+=u.dy*dt*0.1;
    if(u.x<0||u.x>W)u.dx*=-1;
    if(u.y<0||u.y>H)u.dy*=-1;
    ctx.font="32px serif";ctx.fillText(u.emoji,u.x,u.y);
  }
  if(btn(250,1150,220,70,"Restart"))scene="title";
}

let last=0;
function loop(t){
  const dt=t-last;last=t;
  if(scene==="title")drawTitle();else drawBattle(dt);
  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);
</script>
</body>
</html>
